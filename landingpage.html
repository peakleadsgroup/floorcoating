<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Floor Coating Qualification | Peak Floor Coating</title>
    <link rel="icon" type="image/x-icon" href="https://github.com/peakleadsgroup/floorcoating/blob/main/images/PeakFavicon.jpg?raw=true">
    
    <!-- Meta Pixel Code -->
    <!-- PLACEHOLDER: Add your Meta Pixel code here -->
    <!-- 
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', 'YOUR_PIXEL_ID');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=YOUR_PIXEL_ID&ev=PageView&noscript=1"
    /></noscript>
    -->
    <!-- End Meta Pixel Code -->
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), 
                        url('https://github.com/peakleadsgroup/floorcoating/blob/main/images/1-HomePage.png?raw=true') center/cover no-repeat fixed;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .content-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            width: 100%;
            max-width: 500px;
        }
        .form-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            width: 100%;
            text-align: center;
        }
        .logo-container {
            margin-bottom: 30px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .logo-img {
            max-width: 280px;
            max-height: 80px;
            object-fit: contain;
        }
        .main-heading {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 30px;
            line-height: 1.4;
        }
        .highlight {
            background: #ffeb3b;
            padding: 2px 6px;
            border-radius: 4px;
        }
        .question {
            font-size: 20px;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: bold;
        }
        .sub-heading {
            font-size: 14px;
            color: #666;
            margin-bottom: 25px;
            font-style: italic;
        }
        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }
        .option {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px 20px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        .option:hover {
            background: #e3f2fd;
            border-color: #2196f3;
        }
        .option.selected {
            background: #e3f2fd;
            border-color: #2196f3;
            color: #1976d2;
        }
        .address-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }
        .address-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .address-input {
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            background: #f8f9fa;
            width: 100%;
        }
        .address-input:focus {
            outline: none;
            border-color: #2196f3;
            background: #fff;
        }
        .address-input.error {
            border-color: #f44336;
        }
        .address-field {
            display: flex;
            flex-direction: column;
        }
        .address-label {
            font-weight: bold;
            margin-bottom: 8px;
            color: #2c3e50;
            text-align: left;
            font-size: 14px;
        }
        .address-error {
            color: #f44336;
            font-size: 12px;
            margin-top: 5px;
            text-align: left;
            display: none;
        }
        .hidden-initially {
            display: none !important;
        }
        .form-step {
            display: none;
        }
        .form-step.active {
            display: block;
        }
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: #4CAF50;
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        .nav-buttons {
            display: flex;
            justify-content: center;
            margin-top: 30px;
        }
        .nav-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .nav-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }
        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        .name-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }
        .phone-step label {
            font-weight: 600;
            margin-bottom: 6px;
            display: block;
            color: #2c3e50;
            text-align: left;
        }
        .phone-help {
            color: #666;
            font-size: 12px;
            margin-top: 5px;
            display: block;
            text-align: left;
        }
        .row {
            display: grid;
            gap: 15px;
            margin-bottom: 20px;
        }
        #phone, #phone2 {
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            background: #f8f9fa;
            width: 100%;
        }
        #phone:focus, #phone2:focus {
            outline: none;
            border-color: #2196f3;
            background: #fff;
        }
        /* Phone/Text Button Styles */
        .contact-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            color: white;
            text-decoration: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-size: 20px;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 15px;
        }
        
        .call-button {
            background: #10b981;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }
        
        .call-button:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.5);
        }
        
        .text-button {
            background: #3b82f6;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }
        
        .text-button:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.5);
        }
        
        .contact-button:active {
            transform: translateY(0);
        }
        
        .phone-icon,
        .message-icon {
            width: 24px;
            height: 24px;
        }
        
        .phone-number-display {
            color: #4CAF50;
            font-size: 24px;
            font-weight: 700;
            margin-top: 20px;
            letter-spacing: 1px;
        }
        /* Calendar Styles */
        .calendar-step-header {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2c3e50;
            text-align: center;
        }
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .month-nav {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 0 auto;
        }
        .month-display {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            min-width: 180px;
            text-align: center;
        }
        .nav-button {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .nav-button:hover:not(:disabled) {
            background: #4CAF50;
            border-color: #4CAF50;
            color: white;
        }
        .nav-button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        .weekday-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-bottom: 8px;
        }
        .weekday-name {
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            color: #868e96;
            padding: 10px 5px;
            text-transform: uppercase;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }
        .calendar-day {
            aspect-ratio: 1;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 500;
            color: #333;
            position: relative;
        }
        .month-label {
            position: absolute;
            top: 4px;
            font-size: 10px;
            font-weight: 600;
            color: #4CAF50;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .calendar-day:hover:not(.disabled) {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.2);
            border-color: #4CAF50;
            background: #4CAF50;
            color: white;
        }
        .calendar-day:hover:not(.disabled) .month-label {
            color: white;
        }
        .calendar-day.selected {
            background: #4CAF50;
            border-color: #4CAF50;
            color: white;
            transform: scale(1.05);
        }
        .calendar-day.selected .month-label {
            color: white;
        }
        .calendar-day.disabled {
            opacity: 0.3;
            cursor: not-allowed;
            background: transparent;
            pointer-events: none;
        }
        .calendar-day.today {
            border-color: #4CAF50;
            font-weight: 700;
        }
        .time-section {
            margin-top: 20px;
        }
        .selected-info {
            background: #e8f5e9;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: center;
        }
        .selected-info h3 {
            font-size: 14px;
            color: #2e7d32;
            margin-bottom: 5px;
            font-weight: 600;
        }
        .selected-info p {
            font-size: 16px;
            color: #1b5e20;
            font-weight: 600;
            margin: 0;
        }
        .time-grid {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .time-slot {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 16px;
        }
        .time-slot:hover {
            background: #4CAF50;
            border-color: #4CAF50;
            color: white;
            transform: translateY(-2px);
        }
        .no-slots {
            text-align: center;
            padding: 40px 20px;
            color: #868e96;
        }
        .no-slots svg {
            margin-bottom: 10px;
            opacity: 0.5;
        }
        /* Color Gallery Slider Styles */
        .color-gallery-section {
            margin-top: 30px;
            padding: 30px 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            width: 100%;
        }
        .color-gallery-title {
            font-size: 22px;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }
        .color-slider-container {
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            width: 100%;
        }
        .color-slider-track {
            display: flex;
            will-change: transform;
        }
        .color-slider-track.scrolling {
            animation: scrollColors 30s linear infinite;
        }
        .color-slider-track.paused {
            animation-play-state: paused;
        }
        .color-slider-track.fast-forward {
            animation: scrollColors 10s linear infinite;
        }
        .color-slider-track.reverse {
            animation: scrollColorsReverse 30s linear infinite;
        }
        @keyframes scrollColors {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-50%);
            }
        }
        @keyframes scrollColorsReverse {
            0% {
                transform: translateX(-50%);
            }
            100% {
                transform: translateX(0);
            }
        }
        .color-slide {
            min-width: calc(100% / 2.5);
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        .color-slide:hover {
            transform: scale(1.05);
        }
        .color-image {
            width: 100%;
            max-width: 300px;
            height: 200px;
            object-fit: cover;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
        }
        .color-name {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            text-align: center;
        }
        .slider-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
        }
        .slider-arrow {
            background: #4CAF50;
            border: none;
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 24px;
            font-weight: bold;
            flex-shrink: 0;
        }
        .slider-arrow:hover {
            background: #45a049;
            transform: scale(1.1);
        }
        .slider-arrow:active {
            transform: scale(0.95);
        }
        .slider-dots {
            display: flex;
            gap: 8px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            max-width: 300px;
        }
        @media (max-width: 768px) {
            .slider-arrow {
                display: none;
            }
        }
        .slider-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #ccc;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .slider-dot.active {
            background: #4CAF50;
            transform: scale(1.2);
        }
        @media (max-width: 600px) {
            .form-container {
                padding: 25px;
                margin: 10px;
            }
            .color-gallery-section {
                margin-top: 20px;
                padding: 25px 15px;
            }
            .color-gallery-title {
                font-size: 20px;
            }
            .color-image {
                height: 180px;
            }
            .color-name {
                font-size: 16px;
            }
            .address-row {
                grid-template-columns: 1fr;
            }
            .name-grid {
                grid-template-columns: 1fr;
            }
            .main-heading {
                font-size: 20px;
            }
            .question {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="content-wrapper">
    <div class="form-container">
        <div class="logo-container">
            <img src="https://github.com/peakleadsgroup/floorcoating/blob/main/images/PeakFloorCoating-1000x250-NoBack.png?raw=true" 
                 alt="Peak Floor Coating" 
                 class="logo-img">
        </div>
        <div id="mainHeading">
            <h1 class="main-heading">
                Take our 30 second quiz to get a <span class="highlight">fast and free quote</span>
            </h1>
        </div>
        <div class="progress-bar" id="progressBarContainer">
            <div class="progress-fill" id="progressFill" style="width: 14.3%"></div>
        </div>

        <!-- STEP 1: Homeowner -->
        <div class="form-step active" id="step1">
            <div class="question">Are you a homeowner?</div>
            <div class="options">
                <div class="option" onclick="selectOptionAndAdvance(this, 'homeowner', 'yes')">Yes</div>
                <div class="option" onclick="selectOptionAndAdvance(this, 'homeowner', 'no')">No</div>
            </div>
        </div>

        <!-- STEP 2: Floor Location -->
        <div class="form-step" id="step2">
            <div class="question">What floor are you upgrading?</div>
            <div class="options">
                <div class="option" onclick="selectOptionAndAdvance(this, 'floorLocation', 'garage')">Garage</div>
                <div class="option" onclick="selectOptionAndAdvance(this, 'floorLocation', 'basement')">Basement</div>
                <div class="option" onclick="selectOptionAndAdvance(this, 'floorLocation', 'patio')">Patio</div>
                <div class="option" onclick="selectOptionAndAdvance(this, 'floorLocation', 'other')">Other</div>
            </div>
        </div>

        <!-- STEP 3: Project Timeline -->
        <div class="form-step" id="step3">
            <div class="question">When would you like your floors completed?</div>
            <div class="sub-heading">We only schedule projects that can start soon so you can enjoy your upgraded space</div>
            <div class="options">
                <div class="option" onclick="selectOptionAndAdvance(this, 'projectTimeline', 'asap')">ASAP</div>
                <div class="option" onclick="selectOptionAndAdvance(this, 'projectTimeline', 'within_month')">Within a month</div>
                <div class="option" onclick="selectOptionAndAdvance(this, 'projectTimeline', 'within_3_months')">Within 3 months</div>
                <div class="option" onclick="selectOptionAndAdvance(this, 'projectTimeline', 'not_sure')">Not sure</div>
            </div>
        </div>

        <!-- STEP 4: Main Goal -->
        <div class="form-step" id="step4">
            <div class="question">What do you want most in your new floors?</div>
            <div class="options">
                <div class="option" onclick="selectOptionAndAdvance(this, 'mainGoal', 'upgrade_look')">Upgrade look</div>
                <div class="option" onclick="selectOptionAndAdvance(this, 'mainGoal', 'increase_value')">Increase value</div>
                <div class="option" onclick="selectOptionAndAdvance(this, 'mainGoal', 'make_tougher')">Make tougher</div>
            </div>
        </div>

        <!-- STEP 5: Address -->
        <div class="form-step" id="step5">
            <div class="question">What is the location of this project?</div>
            <div class="sub-heading">Please make sure your address is full and correct so we can confirm you are within our service area</div>
            <div class="address-grid">
                <div class="address-field">
                    <label class="address-label" for="street">Street Address</label>
                    <input type="text" class="address-input" id="street" placeholder="Street Address" oninput="validateAddressForm()">
                    <div class="address-error" id="streetError">Street address must start with a number</div>
                </div>
                
                <div id="cityField" class="address-field hidden-initially">
                    <label class="address-label" for="city">City</label>
                    <input type="text" class="address-input" id="city" placeholder="City" oninput="validateAddressForm()">
                </div>
                
                <div class="address-row hidden-initially" id="stateZipRow">
                    <div class="address-field">
                        <label class="address-label" for="state">State</label>
                        <input type="text" class="address-input" id="state" placeholder="State" oninput="validateAddressForm()">
                    </div>
                    <div class="address-field">
                        <label class="address-label" for="zip">Zip Code</label>
                        <input type="text" class="address-input" id="zip" placeholder="Zip Code" oninput="validateAddressForm()" maxlength="5">
                    </div>
                </div>
            </div>
            <div class="nav-buttons">
                <button class="nav-btn" onclick="goToStep6()" id="submitFormBtn" disabled>Next</button>
            </div>
        </div>

        <!-- STEP 6: NAME -->
        <div class="form-step" id="step6">
            <div class="question">Who will we be making this quote out to?</div>
            <div class="name-grid">
                <div>
                    <label for="firstName" style="margin-bottom: 10px; display: block; color: #2c3e50; text-align: center;">First Name</label>
                    <input type="text" class="address-input" id="firstName" placeholder="First Name" required autocomplete="given-name" oninput="validateNameForm()">
                </div>
                <div>
                    <label for="lastName" style="margin-bottom: 10px; display: block; color: #2c3e50; text-align: center;">Last Name</label>
                    <input type="text" class="address-input" id="lastName" placeholder="Last Name" required autocomplete="family-name" oninput="validateNameForm()">
                </div>
            </div>
            <div class="nav-buttons">
                <button class="nav-btn" onclick="goToStep7()" id="nameNextBtn" disabled>Next</button>
            </div>
        </div>

        <!-- STEP 7: PHONE -->
        <div class="form-step" id="step7">
            <div class="question">Where can we reach you with your quote?</div>
            <div class="row">
                <div id="phoneWrap">
                    <label for="phone">Phone</label>
                    <input id="phone" name="phone" type="tel" inputmode="tel" placeholder="(___) ___-____" required autocomplete="tel" aria-describedby="phoneHelp">
                    <small id="phoneHelp" class="phone-help">US number, 10 digits.</small>
                    <input type="hidden" id="phone_digits" name="phone_digits" value="">
                </div>
                <div id="phoneConfirmWrap" style="display:none">
                    <label for="phone2">Please re-enter your phone</label>
                    <input id="phone2" name="phone_confirm" type="tel" inputmode="tel" placeholder="(___) ___-____" autocomplete="tel" aria-describedby="phone2Help">
                    <small id="phone2Help" class="phone-help">Must match exactly.</small>
                </div>
            </div>
            <div class="nav-buttons">
                <button class="nav-btn" onclick="submitFinalForm()" id="phoneSubmitBtn" disabled>Get My Quote</button>
            </div>
        </div>

        <!-- PHONE/TEXT CONTACT SCREEN -->
        <div class="form-step" id="contactStep">
            <div style="text-align: center;">
                <div style="font-size: 24px; color: #4CAF50; margin-bottom: 20px; font-weight: bold;">We'll call you soon to schedule your free estimate!</div>
                <div style="font-size: 16px; color: #666; line-height: 1.5; margin-bottom: 30px;">Or if you're ready to schedule now you can contact us by clicking one of the buttons below</div>
                
                <a href="tel:+19193634740" class="contact-button call-button">
                    <svg class="phone-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56a.977.977 0 00-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"/>
                    </svg>
                    Call
                </a>
                
                <a href="sms:+19193634740?&body=Hey%2C%20this%20is%20Drew%21%20I%20just%20saw%20your%20video%20on%20social%20media%20and%20would%20like%20to%20schedule%20an%20appointment%20to%20get%20my%20free%2C%20no%20obligation%20quote.%20Please%20send%20me%20some%20days%2Ftimes%20that%20you%27re%20available%21" class="contact-button text-button">
                    <svg class="message-icon" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9 11H7V9h2v2zm4 0h-2V9h2v2zm4 0h-2V9h2v2z"/>
                    </svg>
                    Text
                </a>
                
                <div class="phone-number-display">(919) 363-4740</div>
            </div>
        </div>

        <!-- CALENDAR BOOKING SCREEN -->
        <div class="form-step" id="calendarStep">
            <div class="calendar-step-header">We'll reach out soon to schedule your free estimate!</div>
            <div style="font-size: 16px; color: #666; margin-bottom: 25px; text-align: center;">Ready to schedule your free estimate now? Choose a time below:</div>
            
            <div class="calendar-header">
                <div class="month-nav">
                    <button class="nav-button" id="prevMonth" onclick="changeCalendarMonth(-1)">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M15 18l-6-6 6-6"/>
                        </svg>
                    </button>
                    <div class="month-display" id="monthDisplay"></div>
                </div>
            </div>
            
            <div class="weekday-header">
                <div class="weekday-name">Sun</div>
                <div class="weekday-name">Mon</div>
                <div class="weekday-name">Tue</div>
                <div class="weekday-name">Wed</div>
                <div class="weekday-name">Thu</div>
                <div class="weekday-name">Fri</div>
                <div class="weekday-name">Sat</div>
            </div>
            
            <div class="calendar-grid" id="calendarGrid"></div>
            
            <div id="timeSection" class="time-section" style="display: none;">
                <div class="selected-info" id="selectedDayInfo"></div>
                <div class="time-grid" id="timeGrid"></div>
            </div>
        </div>

        <!-- CONFIRMATION/THANK YOU SCREEN -->
        <div class="form-step" id="confirmationStep">
            <div style="text-align: center; padding: 40px 20px;">
                <div style="margin-bottom: 30px;">
                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#4CAF50" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin: 0 auto; display: block;">
                        <circle cx="12" cy="12" r="10" fill="#e8f5e9"/>
                        <path d="M9 12l2 2 4-4" stroke="#4CAF50" stroke-width="3"/>
                    </svg>
                </div>
                <div style="font-size: 28px; color: #2c3e50; margin-bottom: 20px; font-weight: bold;">Thank you!</div>
                <div style="font-size: 18px; color: #666; line-height: 1.6;">We'll give you a call soon to schedule your free estimate.</div>
            </div>
        </div>
    </div>

    <!-- Color Gallery Slider Section -->
    <div class="color-gallery-section">
        <h2 class="color-gallery-title">Explore Our Color Options</h2>
        <div class="color-slider-container" id="colorSliderContainer">
            <div class="color-slider-track scrolling" id="colorSliderTrack">
                <!-- Slides will be generated by JavaScript -->
            </div>
        </div>
        <div class="slider-controls">
            <button class="slider-arrow" id="prevColorBtn" aria-label="Previous color">‹</button>
            <div class="slider-dots" id="colorDots"></div>
            <button class="slider-arrow" id="nextColorBtn" aria-label="Next color">›</button>
        </div>
    </div>
    </div>

    <script>
        // ============================================
        // CONFIGURATION - Change this to switch behavior
        // ============================================
        const REDIRECT_MODE = 'external_calendar'; // Options: 'calendar', 'phone', 'none', or 'external_calendar'
        const CLIENT_PHONE = '+19193634740'; // Client phone number for call/text buttons
        
        // ZIP CODE ROUTING CONFIGURATION
        // PLACEHOLDER: Add your zip code routing logic here
        const mondayThursdayZips = new Set([
            // Add zip codes that should use Monday-Thursday calendar
        ]);
        
        const regularCalendarZips = new Set([
            // Add zip codes that should use regular calendar
        ]);
        
        // Calendar Configuration (only used if REDIRECT_MODE = 'calendar')
        const CALENDAR_CONFIG = {
            timezone: 'America/New_York',
            daysOut: 14,
            minHoursInAdvance: 48,
            availableDaysOfWeek: [1, 2, 3, 4, 5], // Monday-Friday
            timeWindows: [
                { start: '08:00', end: '17:00' }
            ]
        };
        
        // Webhook URL for form submissions
        // PLACEHOLDER: Add your webhook URL here
        const WEBHOOK_URL = 'YOUR_WEBHOOK_URL_HERE';
        
        // Calendar Webhook URL for calendar bookings
        const CALENDAR_WEBHOOK_URL = 'YOUR_CALENDAR_WEBHOOK_URL_HERE';
        
        // ============================================
        let currentStep = 1;
        let formData = {};
        let eventId = null;
        let hasTrackedEngagement = false;

        function generateEventId() {
            return 'event_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        function selectOptionAndAdvance(element, field, value) {
            const options = element.parentElement.querySelectorAll('.option');
            options.forEach(opt => opt.classList.remove('selected'));
            
            element.classList.add('selected');
            formData[field] = value;
            
            if (!hasTrackedEngagement) {
                if (typeof fbq !== 'undefined') {
                    fbq('track', 'ViewContent', {
                        content_category: 'home_improvement',
                        content_name: 'floor_coating_quiz_start'
                    });
                }
                hasTrackedEngagement = true;
            }
            
            setTimeout(() => {
                nextStep();
            }, 200);
        }

        function validateAddressForm() {
            const street = document.getElementById('street').value.trim();
            const city = document.getElementById('city').value.trim();
            const state = document.getElementById('state').value.trim();
            const zip = document.getElementById('zip').value.trim();
            const cityField = document.getElementById('cityField');
            const stateZipRow = document.getElementById('stateZipRow');
            const streetInput = document.getElementById('street');
            const streetError = document.getElementById('streetError');
            
            // Check if street starts with a number
            const startsWithNumber = /^\d/.test(street);
            
            if (street.length > 0) {
                if (!startsWithNumber) {
                    streetInput.classList.add('error');
                    streetError.style.display = 'block';
                } else {
                    streetInput.classList.remove('error');
                    streetError.style.display = 'none';
                }
                
                cityField.classList.remove('hidden-initially');
                stateZipRow.classList.remove('hidden-initially');
            } else {
                streetInput.classList.remove('error');
                streetError.style.display = 'none';
                cityField.classList.add('hidden-initially');
                stateZipRow.classList.add('hidden-initially');
                document.getElementById('city').value = '';
                document.getElementById('state').value = '';
                document.getElementById('zip').value = '';
            }
            
            const submitBtn = document.getElementById('submitFormBtn');
            if (submitBtn) {
                submitBtn.disabled = !(street && city && state && zip && startsWithNumber);
            }
            
            if (street && city && state && zip && startsWithNumber) {
                formData.address = { street, city, state, zip };
            }
        }

        function updateProgress() {
            const progressFill = document.getElementById('progressFill');
            const percentage = (currentStep / 7) * 100;
            progressFill.style.width = percentage + '%';
        }

        function nextStep() {
            if (currentStep < 7) {
                document.getElementById('step' + currentStep).classList.remove('active');
                currentStep++;
                document.getElementById('step' + currentStep).classList.add('active');
                updateProgress();
            }
        }

        function goToStep6() {
            validateAddressForm();
            if (formData.address) {
                nextStep();
            }
        }

        function validateNameForm() {
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const nameNextBtn = document.getElementById('nameNextBtn');
            
            if (nameNextBtn) {
                nameNextBtn.disabled = !(firstName && lastName);
            }
            
            if (firstName && lastName) {
                formData.firstName = firstName;
                formData.lastName = lastName;
            }
        }

        function goToStep7() {
            validateNameForm();
            if (formData.firstName && formData.lastName) {
                nextStep();
                setupPhoneValidation();
            }
        }

        function formatPhone(val) {
            const d = val.replace(/\D/g,'').slice(0,10);
            let f = d;
            if(d.length > 6) f = `(${d.slice(0,3)}) ${d.slice(3,6)}-${d.slice(6)}`;
            else if(d.length > 3) f = `(${d.slice(0,3)}) ${d.slice(3)}`;
            else if(d.length > 0) f = `(${d}`;
            return {formatted:f, digits:d};
        }

        function isValidPhoneNumber(digits) {
            // Check 1: Must be exactly 10 digits
            if (digits.length !== 10) {
                return { valid: false, error: 'Phone number must be 10 digits.' };
            }

            // Check 2: Cannot start with 1
            if (digits.charAt(0) === '1') {
                return { valid: false, error: "Phone number shouldn't start with a 1." };
            }

            const areaCode = digits.substring(0, 3);
            const exchange = digits.substring(3, 6);
            const lineNumber = digits.substring(6, 10);

            // Check 3: Area code validation - repeating digits (000, 111, 222, etc)
            if (/^(\d)\1{2}$/.test(areaCode)) {
                return { valid: false, error: 'Invalid area code.' };
            }

            // Check 4: Area code validation - 555
            if (areaCode === '555') {
                return { valid: false, error: 'Area code 555 is not valid.' };
            }

            // Check 5: Area code validation - toll-free numbers
            const tollFreeAreaCodes = ['800', '888', '877', '866', '855', '844', '833'];
            if (tollFreeAreaCodes.includes(areaCode)) {
                return { valid: false, error: 'Toll-free numbers are not accepted.' };
            }

            // Check 6: Exchange code validation - special services
            const specialExchanges = ['911', '411', '611'];
            if (specialExchanges.includes(exchange)) {
                return { valid: false, error: 'Invalid exchange code.' };
            }

            // Check 7: Exchange code validation - cannot start with 0 or 1
            if (exchange.charAt(0) === '0' || exchange.charAt(0) === '1') {
                return { valid: false, error: 'Invalid exchange code.' };
            }

            // Check 8: Sequential digits (ascending)
            if (digits === '1234567890' || digits === '0123456789') {
                return { valid: false, error: 'Sequential numbers are not valid.' };
            }

            for (let i = 0; i < digits.length - 2; i++) {
                const digit1 = parseInt(digits.charAt(i));
                const digit2 = parseInt(digits.charAt(i + 1));
                const digit3 = parseInt(digits.charAt(i + 2));
                
                if (digit2 === digit1 + 1 && digit3 === digit2 + 1) {
                    let sequentialCount = 3;
                    for (let j = i + 3; j < digits.length; j++) {
                        if (parseInt(digits.charAt(j)) === parseInt(digits.charAt(j - 1)) + 1) {
                            sequentialCount++;
                        } else {
                            break;
                        }
                    }
                    if (sequentialCount >= 7) {
                        return { valid: false, error: 'Sequential numbers are not valid.' };
                    }
                }
            }

            // Check 9: All same digits (555-555-5555, etc)
            if (/^(\d)\1{9}$/.test(digits)) {
                return { valid: false, error: 'All digits cannot be the same.' };
            }

            // Check 10: Repeating patterns (123-123-1234, 456-456-4567)
            if (areaCode === exchange && areaCode === lineNumber.substring(0, 3)) {
                return { valid: false, error: 'Repeating patterns are not valid.' };
            }

            // Check 11: Known fake/test numbers (555-0100 through 555-0199)
            if (exchange === '555' && lineNumber.startsWith('01')) {
                return { valid: false, error: 'Test numbers are not valid.' };
            }

            // Check 12: Wildcard/placeholder detection - multiple zeros in a row
            if (digits.includes('000') || digits.includes('0000')) {
                return { valid: false, error: 'Invalid phone number format.' };
            }

            // Check 13: 999-9999 patterns
            if (lineNumber === '9999' || exchange === '999') {
                return { valid: false, error: 'Invalid phone number format.' };
            }

            return { valid: true, error: '' };
        }

        function validatePhones() {
            const phoneInput = document.getElementById('phone');
            const phone2Input = document.getElementById('phone2');
            const phoneConfirmWrap = document.getElementById('phoneConfirmWrap');
            const phoneDigits = document.getElementById('phone_digits');
            const phoneSubmitBtn = document.getElementById('phoneSubmitBtn');
            
            if (!phoneInput) return;
            const p1 = formatPhone(phoneInput.value);
            if (phoneInput.value !== p1.formatted) phoneInput.value = p1.formatted;
            phoneDigits.value = p1.digits;
            let phoneError = document.getElementById('phoneError');
            if (!phoneError) {
                phoneError = document.createElement('div');
                phoneError.id = 'phoneError';
                phoneError.style.color = 'red';
                phoneError.style.fontSize = '12px';
                phoneError.style.marginTop = '5px';
                phoneError.style.display = 'none';
                
                const phoneHelp = document.getElementById('phoneHelp');
                if (phoneHelp) {
                    phoneHelp.parentNode.insertBefore(phoneError, phoneHelp.nextSibling);
                }
            }

            // Validate phone number with all checks
            const validation = isValidPhoneNumber(p1.digits);
            
            if (p1.digits.length > 0 && !validation.valid) {
                phoneError.textContent = validation.error;
                phoneError.style.display = 'block';
                phoneInput.setCustomValidity(validation.error);
            } else {
                phoneError.style.display = 'none';
                if(p1.digits.length === 10 && validation.valid){
                    phoneInput.setCustomValidity('');
                } else if (p1.digits.length > 0 && p1.digits.length < 10) {
                    phoneInput.setCustomValidity('Please enter a valid 10-digit phone number.');
                }
            }

            const shouldShowConfirm = p1.digits.length === 10 && validation.valid;
            phoneConfirmWrap.style.display = shouldShowConfirm ? '' : 'none';
            if (phone2Input) phone2Input.required = shouldShowConfirm;
            const p2 = formatPhone(phone2Input ? phone2Input.value : '');
            if (phone2Input && phone2Input.value !== p2.formatted) phone2Input.value = p2.formatted;
            if(shouldShowConfirm && phone2Input){
                if(p2.digits.length === 0){
                    phone2Input.setCustomValidity('Please re-enter your phone number.');
                } else if(p2.digits !== p1.digits){
                    phone2Input.setCustomValidity('Phone numbers do not match.');
                } else {
                    phone2Input.setCustomValidity('');
                }
            } else if (phone2Input) {
                phone2Input.value = '';
                phone2Input.setCustomValidity('');
            }

            const phoneValid = p1.digits.length === 10 && validation.valid;
            const phone2Valid = !shouldShowConfirm || (p2.digits.length === 10 && p2.digits === p1.digits);
            const buttonShouldEnable = phoneValid && phone2Valid;
            
            if (phoneSubmitBtn) {
                phoneSubmitBtn.disabled = !buttonShouldEnable;
            }
        }

        function setupPhoneValidation() {
            const phoneInput = document.getElementById('phone');
            const phone2Input = document.getElementById('phone2');
            
            if (phoneInput) {
                phoneInput.addEventListener('input', validatePhones);
                phoneInput.addEventListener('blur', validatePhones);
            }
            
            if (phone2Input) {
                phone2Input.addEventListener('input', validatePhones);
                phone2Input.addEventListener('blur', validatePhones);
            }
        }

        // ============================================
        // CALENDAR FUNCTIONS
        // ============================================
        
        let selectedDate = null;
        let selectedTime = null;
        let currentWeekStart = null;
        
        function getCurrentDateInTimezone() {
            return new Date(new Date().toLocaleString('en-US', { timeZone: CALENDAR_CONFIG.timezone }));
        }
        
        function initializeCalendar() {
            const now = getCurrentDateInTimezone();
            now.setHours(0, 0, 0, 0);
            currentWeekStart = new Date(now);
            
            const firstAvailable = renderCalendar();
            
            if (firstAvailable.date && firstAvailable.formatted) {
                selectCalendarDay(firstAvailable.date, firstAvailable.formatted.fullDate);
            }
        }
        
        function isToday(date) {
            const today = getCurrentDateInTimezone();
            return date.getDate() === today.getDate() &&
                   date.getMonth() === today.getMonth() &&
                   date.getFullYear() === today.getFullYear();
        }
        
        function isDayOfWeekAvailable(date) {
            return CALENDAR_CONFIG.availableDaysOfWeek.includes(date.getDay());
        }
        
        function isWithinBookingWindow(date) {
            const now = getCurrentDateInTimezone();
            const hoursFromNow = (date - now) / (1000 * 60 * 60);
            
            if (hoursFromNow < CALENDAR_CONFIG.minHoursInAdvance) return false;
            
            const maxDate = new Date(now);
            maxDate.setDate(now.getDate() + CALENDAR_CONFIG.daysOut);
            
            return date <= maxDate;
        }
        
        function getAvailableTimesForDate(date) {
            if (!date) return [];
            
            const slots = [];
            const now = getCurrentDateInTimezone();
            
            CALENDAR_CONFIG.timeWindows.forEach(window => {
                const [startHour, startMin] = window.start.split(':').map(Number);
                const [endHour, endMin] = window.end.split(':').map(Number);
                
                let currentSlot = new Date(date);
                currentSlot.setHours(startHour, startMin, 0, 0);
                
                const windowEnd = new Date(date);
                windowEnd.setHours(endHour, endMin, 0, 0);
                
                while (currentSlot < windowEnd) {
                    const slotTime = new Date(currentSlot);
                    const hoursFromNow = (slotTime - now) / (1000 * 60 * 60);
                    
                    if (hoursFromNow >= CALENDAR_CONFIG.minHoursInAdvance) {
                        const hours = slotTime.getHours();
                        const minutes = slotTime.getMinutes();
                        const ampm = hours >= 12 ? 'PM' : 'AM';
                        const displayHours = hours % 12 || 12;
                        const displayMinutes = minutes.toString().padStart(2, '0');
                        
                        slots.push({
                            time: slotTime,
                            display: `${displayHours}:${displayMinutes} ${ampm}`,
                            isoString: slotTime.toISOString()
                        });
                    }
                    
                    currentSlot.setMinutes(currentSlot.getMinutes() + 60);
                }
            });
            
            return slots;
        }
        
        function formatDate(date) {
            return {
                fullDate: date.toLocaleDateString('en-US', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    timeZone: CALENDAR_CONFIG.timezone
                })
            };
        }
        
        function renderCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            const monthDisplay = document.getElementById('monthDisplay');
            calendarGrid.innerHTML = '';
            
            const now = getCurrentDateInTimezone();
            now.setHours(0, 0, 0, 0);
            
            const startDate = new Date(currentWeekStart);
            const startDayOfWeek = startDate.getDay();
            startDate.setDate(startDate.getDate() - startDayOfWeek);
            
            const endDate = new Date(startDate);
            endDate.setDate(startDate.getDate() + 20);
            
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 
                          'July', 'August', 'September', 'October', 'November', 'December'];
            const monthsShort = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 
                               'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            
            if (startDate.getMonth() === endDate.getMonth()) {
                monthDisplay.textContent = `${months[startDate.getMonth()]} ${startDate.getFullYear()}`;
            } else {
                monthDisplay.textContent = `${months[startDate.getMonth()]} - ${months[endDate.getMonth()]} ${endDate.getFullYear()}`;
            }
            
            let lastMonth = -1;
            let firstAvailableDate = null;
            let firstAvailableFormatted = null;
            
            for (let i = 0; i < 21; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const isAvailable = isDayOfWeekAvailable(date) && 
                                  isWithinBookingWindow(date) &&
                                  getAvailableTimesForDate(date).length > 0;
                
                const dayCell = document.createElement('div');
                dayCell.className = 'calendar-day';
                dayCell.dataset.date = date.toISOString();
                
                if (isToday(date)) {
                    dayCell.classList.add('today');
                }
                
                if (!isAvailable) {
                    dayCell.classList.add('disabled');
                }
                
                if (isAvailable && !firstAvailableDate) {
                    firstAvailableDate = new Date(date);
                    firstAvailableFormatted = formatDate(date);
                }
                
                if (selectedDate && 
                    date.getDate() === selectedDate.getDate() &&
                    date.getMonth() === selectedDate.getMonth() &&
                    date.getFullYear() === selectedDate.getFullYear()) {
                    dayCell.classList.add('selected');
                }
                
                if (date.getMonth() !== lastMonth && date.getDate() === 1) {
                    const monthLabel = document.createElement('div');
                    monthLabel.className = 'month-label';
                    monthLabel.textContent = monthsShort[date.getMonth()];
                    dayCell.appendChild(monthLabel);
                    lastMonth = date.getMonth();
                }
                
                const dayNumber = document.createElement('div');
                dayNumber.textContent = date.getDate();
                dayCell.appendChild(dayNumber);
                
                if (isAvailable) {
                    const formatted = formatDate(date);
                    dayCell.onclick = () => selectCalendarDay(date, formatted.fullDate);
                }
                
                calendarGrid.appendChild(dayCell);
            }
            
            updateNavigationButtons();
            
            return { date: firstAvailableDate, formatted: firstAvailableFormatted };
        }
        
        function changeCalendarMonth(direction) {
            if (direction < 0) {
                currentWeekStart.setDate(currentWeekStart.getDate() + (direction * 7));
                const firstAvailable = renderCalendar();
                
                if (selectedDate) {
                    const now = getCurrentDateInTimezone();
                    now.setHours(0, 0, 0, 0);
                    const startDate = new Date(currentWeekStart);
                    const startDayOfWeek = startDate.getDay();
                    startDate.setDate(startDate.getDate() - startDayOfWeek);
                    const endDate = new Date(startDate);
                    endDate.setDate(startDate.getDate() + 20);
                    
                    if (selectedDate < startDate || selectedDate > endDate) {
                        if (firstAvailable.date && firstAvailable.formatted) {
                            selectCalendarDay(firstAvailable.date, firstAvailable.formatted.fullDate);
                        }
                    } else {
                        const formatted = formatDate(selectedDate);
                        selectCalendarDay(selectedDate, formatted.fullDate);
                    }
                } else if (firstAvailable.date && firstAvailable.formatted) {
                    selectCalendarDay(firstAvailable.date, firstAvailable.formatted.fullDate);
                }
            }
        }
        
        function updateNavigationButtons() {
            const now = getCurrentDateInTimezone();
            now.setHours(0, 0, 0, 0);
            
            const prevButton = document.getElementById('prevMonth');
            
            if (currentWeekStart >= now) {
                prevButton.disabled = true;
            } else {
                prevButton.disabled = false;
            }
        }
        
        function selectCalendarDay(date, fullDate) {
            selectedDate = date;
            selectedTime = null;
            
            document.querySelectorAll('.calendar-day').forEach(day => {
                day.classList.remove('selected');
            });
            
            document.querySelectorAll('.calendar-day').forEach(day => {
                const dayDate = new Date(day.dataset.date);
                if (dayDate.getDate() === date.getDate() &&
                    dayDate.getMonth() === date.getMonth() &&
                    dayDate.getFullYear() === date.getFullYear()) {
                    day.classList.add('selected');
                }
            });
            
            document.getElementById('selectedDayInfo').innerHTML = `
                <h3>Selected Date</h3>
                <p>${fullDate}</p>
            `;
            
            renderTimes();
            document.getElementById('timeSection').style.display = 'block';
        }
        
        function renderTimes() {
            const timeGrid = document.getElementById('timeGrid');
            timeGrid.innerHTML = '';
            
            const slots = getAvailableTimesForDate(selectedDate);
            
            if (slots.length === 0) {
                timeGrid.innerHTML = `
                    <div class="no-slots">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M12 6v6l4 2"/>
                        </svg>
                        <p>No available times for this day</p>
                    </div>
                `;
                return;
            }
            
            slots.forEach(slot => {
                const timeSlot = document.createElement('div');
                timeSlot.className = 'time-slot';
                timeSlot.textContent = slot.display;
                timeSlot.onclick = () => selectCalendarTime(slot);
                timeGrid.appendChild(timeSlot);
            });
        }
        
        function selectCalendarTime(slot) {
            selectedTime = slot;
            
            const formatted = formatDate(selectedDate);
            const appointmentData = {
                ...formData,
                phone: document.getElementById('phone_digits').value,
                appointment_date: selectedDate.toISOString().split('T')[0],
                appointment_time: slot.display,
                appointment_datetime: slot.isoString,
                appointment_full_text: `${formatted.fullDate} at ${slot.display}`
            };
            
            // Send webhook with appointment data
            if (CALENDAR_WEBHOOK_URL !== 'YOUR_CALENDAR_WEBHOOK_URL_HERE') {
                fetch(CALENDAR_WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(appointmentData),
                    mode: 'no-cors'
                });
            }
            
            // Show confirmation screen
            document.getElementById('calendarStep').classList.remove('active');
            document.getElementById('confirmationStep').classList.add('active');
        }
        
        function showCalendarScreen() {
            document.getElementById('step7').classList.remove('active');
            document.getElementById('calendarStep').classList.add('active');
            document.getElementById('progressBarContainer').style.display = 'none';
            document.getElementById('mainHeading').style.display = 'none';
            
            initializeCalendar();
        }
        
        // ============================================
        // END CALENDAR FUNCTIONS
        // ============================================
        function redirectToCalendar() {
            const firstName = document.getElementById('firstName')?.value.trim() || '';
            const lastName = document.getElementById('lastName')?.value.trim() || '';
            const fullName = `${firstName} ${lastName}`.replace(/\s+/g, ' ').trim();
            
            const street = formData.address?.street || '';
            const city = formData.address?.city || '';
            const state = formData.address?.state || '';
            const zip = formData.address?.zip || '';
            const fullAddress = `${street}, ${city}, ${state} ${zip}`.trim();
            
            // Build Cal.com URL (no lead email; inbox email fixed)
            const params = new URLSearchParams();
            params.set('email', 'peakleadsgroup@gmail.com');        // fixed inbox
            if (fullName) params.set('name', fullName);
            
            // Phone → smsReminderNumber (+1XXXXXXXXXX) if 10 digits present
            const smsDigits = document.getElementById('phone_digits')?.value
                           || document.getElementById('phone')?.value.replace(/\D/g,'') || '';
            if (smsDigits.length === 10) params.set('smsReminderNumber', `+1${smsDigits}`);
            if (fullAddress) params.set('location', fullAddress);   // optional prefill
            
            // CONDITIONAL REDIRECT LOGIC BASED ON ZIP CODE
            let calendarUrl;
            
            if (zip && mondayThursdayZips.has(zip)) {
                // Use Monday-Thursday only calendar for special zip codes
                calendarUrl = `https://cal.com/peakleadsgroup/fortress-floor-coatings-of-nwfl-mon-thurs-only?${params.toString()}`;
                console.log('Redirecting to Monday-Thursday calendar for zip:', zip);
            } else if (zip && regularCalendarZips.has(zip)) {
                // Use regular calendar for specified zip codes
                calendarUrl = `https://cal.com/peakleadsgroup/fortress-floor-coatings-of-nwfl?${params.toString()}`;
                console.log('Redirecting to regular calendar for zip:', zip);
            } else {
                // Zip not in either list - show confirmation/thank you page instead
                console.log('Zip code not in service area, showing thank you page:', zip);
                showConfirmationScreen();
                return; // Don't redirect to calendar
            }
            
            window.location.href = calendarUrl;
        }

        function showContactScreen() {
            // Get lead's name
            const firstName = document.getElementById('firstName')?.value.trim() || '';
            
            // Format phone number for display
            const phoneForDisplay = formatClientPhoneForDisplay(CLIENT_PHONE);
            
            // Build the SMS body with lead's name
            const smsBody = encodeURIComponent(
                `Hey, this is ${firstName}! I just saw your video on social media and would like to schedule an appointment to get my free, no obligation quote. Please send me some days/times that you're available!`
            );
            
            // Update the contact buttons and phone display
            const callButton = document.querySelector('.call-button');
            const textButton = document.querySelector('.text-button');
            const phoneDisplay = document.querySelector('.phone-number-display');
            
            if (callButton) callButton.href = `tel:${CLIENT_PHONE}`;
            if (textButton) textButton.href = `sms:${CLIENT_PHONE}?&body=${smsBody}`;
            if (phoneDisplay) phoneDisplay.textContent = phoneForDisplay;
            
            // Show the contact screen
            document.getElementById('step7').classList.remove('active');
            document.getElementById('contactStep').classList.add('active');
            document.getElementById('progressBarContainer').style.display = 'none';
            document.getElementById('mainHeading').style.display = 'none';
        }

        function showConfirmationScreen() {
            // Show the confirmation/thank you screen
            document.getElementById('step7').classList.remove('active');
            document.getElementById('confirmationStep').classList.add('active');
            document.getElementById('progressBarContainer').style.display = 'none';
            document.getElementById('mainHeading').style.display = 'none';
        }

        function formatClientPhoneForDisplay(phoneNumber) {
            // Remove all non-digit characters
            const digits = phoneNumber.replace(/\D/g, '');
            
            // Format as (XXX) XXX-XXXX
            if (digits.length === 11 && digits.startsWith('1')) {
                // Remove leading 1 for display
                const without1 = digits.substring(1);
                return `(${without1.slice(0,3)}) ${without1.slice(3,6)}-${without1.slice(6)}`;
            } else if (digits.length === 10) {
                return `(${digits.slice(0,3)}) ${digits.slice(3,6)}-${digits.slice(6)}`;
            }
            
            // Return original if format doesn't match
            return phoneNumber;
        }

        function submitFinalForm() {
            eventId = generateEventId();
            
            const finalData = {
                ...formData,
                phone: document.getElementById('phone_digits').value
            };
            
            if (typeof fbq !== 'undefined') {
                fbq('track', 'Lead', {
                    content_category: 'home_improvement',
                    content_name: 'floor_coating_quote',
                    value: 1.00,
                    currency: 'USD',
                    homeowner_status: finalData.homeowner,
                    floor_location: finalData.floorLocation,
                    project_timeline: finalData.projectTimeline,
                    main_goal: finalData.mainGoal
                }, {
                    eventID: eventId
                });
            }
            
            const fullSummary = `Floor Coating Lead Information:

Name: ${finalData.firstName} ${finalData.lastName}

Phone: ${formatPhoneForDisplay(finalData.phone)}

Homeowner: ${finalData.homeowner === 'yes' ? 'Yes' : 'No'}

Floor Location: ${getFloorLocationDisplay(finalData.floorLocation)}

Project Timeline: ${getProjectTimelineDisplay(finalData.projectTimeline)}

Main Goal: ${getMainGoalDisplay(finalData.mainGoal)}

Address:

${finalData.address.street}

${finalData.address.city}, ${finalData.address.state} ${finalData.address.zip}

Lead generated on: ${new Date().toLocaleDateString('en-US', { 
    weekday: 'long', 
    year: 'numeric', 
    month: 'long', 
    day: 'numeric',
    hour: 'numeric',
    minute: '2-digit',
    hour12: true,
    timeZone: 'America/New_York'
})} EST`.trim();

            const fullSummaryHTML = `Floor Coating Lead Information:<BR><BR>Name: ${finalData.firstName} ${finalData.lastName}<BR>Phone: ${formatPhoneForDisplay(finalData.phone)}<BR><BR>Homeowner: ${finalData.homeowner === 'yes' ? 'Yes' : 'No'}<BR>Floor Location: ${getFloorLocationDisplay(finalData.floorLocation)}<BR>Project Timeline: ${getProjectTimelineDisplay(finalData.projectTimeline)}<BR>Main Goal: ${getMainGoalDisplay(finalData.mainGoal)}<BR><BR>Address:<BR>${finalData.address.street}<BR>${finalData.address.city}, ${finalData.address.state} ${finalData.address.zip}<BR><BR>Lead generated on: ${new Date().toLocaleDateString('en-US', { 
    weekday: 'long', 
    year: 'numeric', 
    month: 'long', 
    day: 'numeric',
    hour: 'numeric',
    minute: '2-digit',
    hour12: true,
    timeZone: 'America/New_York'
})} EST`;

            const webhookData = {
                homeowner: finalData.homeowner,
                floor_location: finalData.floorLocation,
                project_timeline: finalData.projectTimeline,
                main_goal: finalData.mainGoal,
                street_address: finalData.address.street,
                city: finalData.address.city,
                state: finalData.address.state,
                zip: finalData.address.zip,
                phone: finalData.phone,
                first_name: finalData.firstName,
                last_name: finalData.lastName,
                full_name: `${finalData.firstName} ${finalData.lastName}`,
                full_summary: fullSummary,
                full_summary_html: fullSummaryHTML,
                timestamp: new Date().toISOString(),
                form_type: 'floor_coating_qualification',
                clientATID: 'recBGmshJCpkj4Jsl',
                adATID: new URLSearchParams(window.location.search).get('adATID'),
                event_id: eventId
            };
            
            if (WEBHOOK_URL !== 'YOUR_WEBHOOK_URL_HERE') {
                fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(webhookData),
                    mode: 'no-cors'
                }).finally(() => {
                    // Route based on REDIRECT_MODE configuration
                    if (REDIRECT_MODE === 'phone') {
                        showContactScreen();
                    } else if (REDIRECT_MODE === 'calendar') {
                        showCalendarScreen();
                    } else if (REDIRECT_MODE === 'none') {
                        showConfirmationScreen();
                    } else {
                        // Default to external calendar redirect
                        redirectToCalendar();
                    }
                });
            } else {
                // No webhook configured, just show confirmation
                if (REDIRECT_MODE === 'phone') {
                    showContactScreen();
                } else if (REDIRECT_MODE === 'calendar') {
                    showCalendarScreen();
                } else if (REDIRECT_MODE === 'none') {
                    showConfirmationScreen();
                } else {
                    redirectToCalendar();
                }
            }
        }

        function formatPhoneForDisplay(digits) {
            if (digits && digits.length === 10) {
                return `(${digits.slice(0,3)}) ${digits.slice(3,6)}-${digits.slice(6)}`;
            }
            return digits;
        }

        function getFloorLocationDisplay(value) {
            const options = {
                'garage': 'Garage',
                'basement': 'Basement',
                'patio': 'Patio',
                'other': 'Other'
            };
            return options[value] || value;
        }

        function getProjectTimelineDisplay(value) {
            const options = {
                'asap': 'ASAP',
                'within_month': 'Within a month',
                'within_3_months': 'Within 3 months',
                'not_sure': 'Not sure'
            };
            return options[value] || value;
        }

        function getMainGoalDisplay(value) {
            const options = {
                'upgrade_look': 'Upgrade look',
                'increase_value': 'Increase value',
                'make_tougher': 'Make tougher'
            };
            return options[value] || value;
        }

        updateProgress();

        // ============================================
        // COLOR GALLERY SLIDER
        // ============================================
        let touchStartX = 0;
        let touchEndX = 0;
        let isReversing = false;
        let speedTimeout = null;
        
        const colorImages = [
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Basil.jpg.jpg?raw=true', name: 'Basil' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Blue-jay.jpg.jpg?raw=true', name: 'Blue Jay' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Cabin-Fever.jpg.jpg?raw=true', name: 'Cabin Fever' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Cardinal.jpg.jpg?raw=true', name: 'Cardinal' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Cinnamon.jpg.jpg?raw=true', name: 'Cinnamon' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Coffee-Bean.jpg.jpg?raw=true', name: 'Coffee Bean' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Cyberspace.jpg.jpg?raw=true', name: 'Cyberspace' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Domino.jpg.jpg?raw=true', name: 'Domino' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Driftwood.jpg.jpg?raw=true', name: 'Driftwood' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Fortress.jpg.jpg?raw=true', name: 'Fortress' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Fog.jpg.jpg?raw=true', name: 'Fog' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Hog.jpg.jpg?raw=true', name: 'Hog' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Latte.jpg.jpg?raw=true', name: 'Latte' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Madras.jpg.jpg?raw=true', name: 'Madras' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Nutmeg.jpg.jpg?raw=true', name: 'Nutmeg' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Olive-Grove.jpg.jpg?raw=true', name: 'Olive Grove' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Pebble-Beach.jpg.jpg?raw=true', name: 'Pebble Beach' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Pecan.jpg.jpg?raw=true', name: 'Pecan' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/River-Rock.jpg.jpg?raw=true', name: 'River Rock' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Sandstone.jpg.jpg?raw=true', name: 'Sandstone' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Sea-Serpants.jpg.jpg?raw=true', name: 'Sea Serpents' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Slatestone.jpg.jpg?raw=true', name: 'Slatestone' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Smoke.jpg.jpg?raw=true', name: 'Smoke' },
            { url: 'https://github.com/peakleadsgroup/floorcoating/blob/main/images/Twilight.jpg-1.webp?raw=true', name: 'Twilight' }
        ];

        function initColorSlider() {
            const sliderTrack = document.getElementById('colorSliderTrack');
            const dotsContainer = document.getElementById('colorDots');
            
            if (!sliderTrack || !dotsContainer) {
                console.error('Color slider elements not found');
                return;
            }
            
            // Clear any existing content
            sliderTrack.innerHTML = '';
            dotsContainer.innerHTML = '';
            
            // Create slides - duplicate the array for seamless infinite scroll
            const allColors = [...colorImages, ...colorImages];
            
            allColors.forEach((color, index) => {
                const slide = document.createElement('div');
                slide.className = 'color-slide';
                slide.dataset.colorIndex = index % colorImages.length;
                slide.innerHTML = `
                    <img src="${color.url}" alt="${color.name}" class="color-image">
                    <div class="color-name">${color.name}</div>
                `;
                slide.onclick = () => pauseOnColorClick(index % colorImages.length);
                sliderTrack.appendChild(slide);
            });
            
            // Create dots for each unique color
            colorImages.forEach((color, index) => {
                const dot = document.createElement('button');
                dot.className = 'slider-dot';
                dot.setAttribute('aria-label', `Go to ${color.name}`);
                dot.onclick = () => pauseOnColorClick(index);
                dotsContainer.appendChild(dot);
            });
            
            // Ensure scrolling class is applied
            sliderTrack.classList.remove('paused', 'fast-forward', 'reverse');
            sliderTrack.classList.add('scrolling');
            
            // Set up arrow buttons for desktop
            const prevBtn = document.getElementById('prevColorBtn');
            const nextBtn = document.getElementById('nextColorBtn');
            
            if (prevBtn) {
                prevBtn.onclick = () => speedUpReverse();
            }
            if (nextBtn) {
                nextBtn.onclick = () => speedUpForward();
            }
            
            // Set up touch events for mobile swipe
            const sliderContainer = document.getElementById('colorSliderContainer');
            if (sliderContainer) {
                sliderContainer.addEventListener('touchstart', handleTouchStart, { passive: true });
                sliderContainer.addEventListener('touchend', handleTouchEnd, { passive: true });
            }
        }

        function pauseOnColorClick(colorIndex) {
            const sliderTrack = document.getElementById('colorSliderTrack');
            
            // Reset any speed changes
            resetSpeed();
            
            // Pause the animation
            sliderTrack.classList.add('paused');
            
            // Update active dot
            document.querySelectorAll('.slider-dot').forEach((dot, i) => {
                dot.classList.toggle('active', i === colorIndex);
            });
            
            // Resume scrolling after 3 seconds
            setTimeout(() => {
                sliderTrack.classList.remove('paused');
            }, 3000);
        }

        function speedUpForward() {
            const sliderTrack = document.getElementById('colorSliderTrack');
            if (!sliderTrack) return;
            resetSpeed();
            sliderTrack.classList.remove('reverse', 'paused');
            sliderTrack.classList.add('fast-forward');
            
            // Reset to normal speed after 2 seconds
            if (speedTimeout) clearTimeout(speedTimeout);
            speedTimeout = setTimeout(() => {
                resetSpeed();
            }, 2000);
        }

        function speedUpReverse() {
            const sliderTrack = document.getElementById('colorSliderTrack');
            if (!sliderTrack) return;
            resetSpeed();
            sliderTrack.classList.remove('scrolling', 'paused');
            sliderTrack.classList.add('reverse');
            
            // Reset to normal forward speed after 2 seconds
            if (speedTimeout) clearTimeout(speedTimeout);
            speedTimeout = setTimeout(() => {
                resetSpeed();
            }, 2000);
        }

        function resetSpeed() {
            const sliderTrack = document.getElementById('colorSliderTrack');
            if (sliderTrack) {
                sliderTrack.classList.remove('fast-forward', 'reverse', 'paused');
                sliderTrack.classList.add('scrolling');
                isReversing = false;
            }
        }

        function handleTouchStart(e) {
            touchStartX = e.changedTouches[0].screenX;
        }

        function handleTouchEnd(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }

        function handleSwipe() {
            const swipeThreshold = 50; // Minimum distance for a swipe
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // Swipe left - speed up forward
                    speedUpForward();
                } else {
                    // Swipe right - reverse/backwards
                    speedUpReverse();
                }
            }
        }

        // Initialize color slider when page loads
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initColorSlider);
        } else {
            // DOM is already loaded
            initColorSlider();
        }
        
        // Also try on window load as backup
        window.addEventListener('load', function() {
            const sliderTrack = document.getElementById('colorSliderTrack');
            if (sliderTrack && sliderTrack.children.length === 0) {
                initColorSlider();
            }
        });

        window.__attachPlaces = function(){
            if(!window.google || !google.maps || !google.maps.places) return;
            
            const addressInput = document.getElementById('street');
            if (!addressInput) return;
            
            const autocomplete = new google.maps.places.Autocomplete(addressInput, {
                types: ['address'],
                componentRestrictions: { country: ['us'] },
                fields: ['address_components','formatted_address','geometry']
            });
            
            autocomplete.addListener('place_changed', ()=>{
                const place = autocomplete.getPlace();
                if(!place || !place.address_components) return;
                const comps = Object.fromEntries(place.address_components.flatMap(c => c.types.map(t => [t, c])));
                
                let streetAddress = '';
                if(comps.street_number) streetAddress += comps.street_number.long_name + ' ';
                if(comps.route) streetAddress += comps.route.long_name;
                if(streetAddress.trim()) addressInput.value = streetAddress.trim();
                
                const cityField = document.getElementById('cityField');
                const stateZipRow = document.getElementById('stateZipRow');
                if (streetAddress.trim()) {
                    cityField.classList.remove('hidden-initially');
                    stateZipRow.classList.remove('hidden-initially');
                }
                
                const cityInput = document.getElementById('city');
                const stateInput = document.getElementById('state');
                const zipInput = document.getElementById('zip');
                
                if(comps.locality && cityInput) cityInput.value = comps.locality.long_name;
                else if(comps.sublocality && cityInput) cityInput.value = comps.sublocality.long_name;
                if(comps.administrative_area_level_1 && stateInput) stateInput.value = comps.administrative_area_level_1.short_name;
                if(comps.postal_code && zipInput) zipInput.value = comps.postal_code.long_name;
                validateAddressForm();
            });
        };
    </script>
    <!-- PLACEHOLDER: Add your Google Maps API key here -->
    <!--
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&libraries=places&callback=__attachPlaces">
    </script>
    -->
</body>
</html>
